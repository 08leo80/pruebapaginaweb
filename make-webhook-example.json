{
  "webhook_configuration": {
    "name": "SegurosPro Chat Webhook",
    "description": "Webhook para procesar mensajes del chat de SegurosPro",
    "method": "POST",
    "content_type": "application/json"
  },
  
  "input_payload_example": {
    "sessionId": "session_1705123456789_abc123def",
    "message": "Hola, quiero cotizar un seguro de auto",
    "timestamp": "2024-01-15T10:30:00.000Z",
    "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",
    "pageUrl": "https://segurospro.com",
    "userInfo": {
      "name": "Juan Pérez",
      "email": "juan@email.com",
      "phone": "555-123-4567",
      "insuranceType": "auto"
    },
    "metadata": {
      "source": "chat_widget",
      "pageSection": "hero",
      "timeOnPage": 120000
    }
  },
  
  "output_response_example": {
    "success": true,
    "reply": "¡Hola Juan! Te ayudo con tu cotización de auto. ¿Qué modelo y año es tu vehículo?",
    "actions": [
      {
        "type": "redirect",
        "url": "/cotizar-auto"
      },
      {
        "type": "notification",
        "message": "Nuevo lead generado"
      }
    ],
    "metadata": {
      "leadScore": 85,
      "nextAction": "follow_up_call",
      "assignedAgent": "maria@segurospro.com"
    }
  },
  
  "make_scenario_structure": {
    "trigger": {
      "type": "webhook",
      "name": "Chat Message Received"
    },
    "modules": [
      {
        "type": "router",
        "name": "Route by Message Type",
        "conditions": [
          {
            "condition": "message contains 'cotizar'",
            "route": "cotization_flow"
          },
          {
            "condition": "message contains 'contacto'",
            "route": "contact_flow"
          },
          {
            "condition": "message contains 'precio'",
            "route": "pricing_flow"
          },
          {
            "condition": "default",
            "route": "general_inquiry_flow"
          }
        ]
      },
      {
        "type": "google_sheets",
        "name": "Save Lead",
        "action": "add_row",
        "spreadsheet": "SegurosPro_Leads",
        "worksheet": "Chat_Leads"
      },
      {
        "type": "email",
        "name": "Notify Team",
        "to": "equipo@segurospro.com",
        "subject": "Nuevo lead del chat",
        "body": "Se recibió una nueva consulta del chat"
      },
      {
        "type": "webhook_response",
        "name": "Send Reply",
        "response": "{{reply_message}}"
      }
    ]
  },
  
  "automation_examples": {
    "cotization_flow": {
      "description": "Flujo para procesar solicitudes de cotización",
      "steps": [
        "Extraer información del cliente",
        "Determinar tipo de seguro",
        "Guardar en CRM",
        "Asignar asesor",
        "Enviar cotización automática",
        "Programar seguimiento"
      ]
    },
    "contact_flow": {
      "description": "Flujo para consultas de contacto",
      "steps": [
        "Proporcionar información de contacto",
        "Ofrecer horarios de atención",
        "Sugerir canales de comunicación"
      ]
    },
    "pricing_flow": {
      "description": "Flujo para consultas de precios",
      "steps": [
        "Explicar estructura de precios",
        "Ofrecer cotización personalizada",
        "Mencionar descuentos disponibles"
      ]
    }
  },
  
  "integration_examples": {
    "google_sheets": {
      "spreadsheet_name": "SegurosPro_Leads",
      "columns": [
        "Timestamp",
        "Session ID",
        "Customer Name",
        "Customer Email",
        "Customer Phone",
        "Insurance Type",
        "Message",
        "Lead Score",
        "Status",
        "Assigned Agent"
      ]
    },
    "email_notifications": {
      "recipients": [
        "equipo@segurospro.com",
        "asesores@segurospro.com"
      ],
      "templates": {
        "new_lead": "Nuevo lead generado desde el chat",
        "high_value_lead": "Lead de alto valor detectado",
        "urgent_inquiry": "Consulta urgente requiere atención inmediata"
      }
    },
    "crm_integration": {
      "hubspot": {
        "endpoint": "https://api.hubapi.com/crm/v3/objects/contacts",
        "properties": {
          "email": "{{email}}",
          "firstname": "{{first_name}}",
          "lastname": "{{last_name}}",
          "phone": "{{phone}}",
          "lifecyclestage": "lead",
          "lead_source": "chat_widget"
        }
      },
      "salesforce": {
        "endpoint": "https://your-instance.salesforce.com/services/data/v52.0/sobjects/Lead",
        "fields": {
          "FirstName": "{{first_name}}",
          "LastName": "{{last_name}}",
          "Email": "{{email}}",
          "Phone": "{{phone}}",
          "Company": "SegurosPro",
          "LeadSource": "Chat Widget"
        }
      }
    }
  },
  
  "response_templates": {
    "greeting": "¡Hola {{name}}! Soy tu asistente virtual de SegurosPro. ¿En qué puedo ayudarte hoy?",
    "cotization_request": "¡Perfecto! Te ayudo con tu cotización de {{insurance_type}}. ¿Podrías proporcionarme algunos datos adicionales?",
    "contact_info": "Puedes contactarnos al 800-123-4567 o por WhatsApp. También puedes llenar el formulario de cotización en nuestra página.",
    "pricing_info": "Nuestros precios son muy competitivos. Te puedo dar una cotización personalizada. ¿Qué tipo de seguro te interesa?",
    "follow_up": "Gracias por tu interés. Un asesor se pondrá en contacto contigo pronto. ¿Te gustaría que te ayude con algo más?"
  },
  
  "error_handling": {
    "webhook_timeout": {
      "description": "Si el webhook no responde en 10 segundos",
      "action": "Usar respuesta automática local"
    },
    "invalid_payload": {
      "description": "Si el payload no es válido",
      "action": "Responder con mensaje de error genérico"
    },
    "service_unavailable": {
      "description": "Si el servicio de Make está caído",
      "action": "Activar modo offline con respuestas locales"
    }
  }
} 